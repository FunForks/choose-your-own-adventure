const readlineSync=require("readline-sync"),storyMap=require("./storyMap");let userName="${username}",guilty=!1;const checkIfGuilty=e=>void 0===e.guilty||e.guilty===guilty;function showScene(e){let t=storyMap[e],n=t.substitution?userName:"";if(console.log(t.text,n),t.action&&perform(t.action),t.choices){let r=t.choices.filter(checkIfGuilty);showPrompt(r)}}function showPrompt(e){let t=e.map(e=>e.text).filter(e=>!!e);if(!t.length)return process.exit();let n=readlineSync.keyInSelect(t,"",{cancel:"Quit",hideEchoBack:!0,mask:""});n<0?(console.log("Thanks for reading!"),process.exit()):showScene(e[n].next)}function perform(e){switch(e){case"enterName":return userName=readlineSync.question("Enter username\n(or press Ctrl-C to exit): ")||"${username}",showScene("audience");case"steal":return guilty=!0}}showScene("start");